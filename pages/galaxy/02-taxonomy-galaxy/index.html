
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Workshop on Tools for Reproducible Research">
      
      
        <meta name="author" content="Jacques Dainat et al.">
      
      
        <link rel="canonical" href="https://Juke34.github.io/workshop-reproducible-research/pages/galaxy/02-taxonomy-galaxy/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>02 taxonomy galaxy - Metagenomics Workshop, using Galaxy</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#taxonomic-profiling" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.md" title="Metagenomics Workshop, using Galaxy" class="md-header__button md-logo" aria-label="Metagenomics Workshop, using Galaxy" data-md-component="logo">
      
  <img src="../../images/IRD.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Metagenomics Workshop, using Galaxy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              02 taxonomy galaxy
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mathis-arnal/Metagenomic_Training.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mathis-arnal/Metagenomic_Training
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../course-information/schedule/" class="md-tabs__link">
        
  
  
    
  
  Schedule

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../metagenomic/00-meta_introduction/" class="md-tabs__link">
          
  
  
    
  
  Tutorials

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.md" title="Metagenomics Workshop, using Galaxy" class="md-nav__button md-logo" aria-label="Metagenomics Workshop, using Galaxy" data-md-component="logo">
      
  <img src="../../images/IRD.png" alt="logo">

    </a>
    Metagenomics Workshop, using Galaxy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mathis-arnal/Metagenomic_Training.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mathis-arnal/Metagenomic_Training
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course-information/schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Metagenomic
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Metagenomic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomic/00-meta_introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomic/01-background-metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Starting a metagenomic project
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomic/03-assessing-read-quality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assessing Read Quality
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomic/04-trimming-filtering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trimming and Filtering
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomic/05-taxonomic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Taxonomy Profiling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metagenomic/06-diversity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Taxonomic Diversity
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Galaxy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Galaxy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-short_intro_galaxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Short intro to Galaxy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/mathis-arnal/Metagenomic_Training.git/edit/main/docs/pages/galaxy/02-taxonomy-galaxy.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/mathis-arnal/Metagenomic_Training.git/raw/main/docs/pages/galaxy/02-taxonomy-galaxy.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<p>The term <strong>"microbiome"</strong> describes "a characteristic microbial community occupying a reasonably well-defined habitat which has distinct physio-chemical properties. The term thus not only refers to the microorganisms involved but also encompasses their theatre of activity" ((whipps1988mycoparasitism )).</p>
<p>Microbiome data can be gathered from different environments such as soil, water or the human gut. The biological interest lies in general in the question how the microbiome present at a specific site influences this environment. To study a microbiome, we need to use indirect methods like metagenomics or metatranscriptomics.</p>
<p><strong>Metagenomic samples</strong> contain DNA from different organisms at a specific site, where the sample was collected. Metagenomic data can be used to find out which organisms coexist in that niche and which genes are present in the different organisms.
<strong>Metatranscriptomic samples</strong> include the transcribed gene products, thus RNA, that therefore allow to not only study the presence of genes but additionally their expression in the given environment. The following tutorial will focus on metagenomics data, but the principle is the same for metatranscriptomics data.</p>
<p>The investigation of microorganisms present at a specific site and their relative abundance is also called <strong>"microbial community profiling"</strong>.
The main objective is to identify the microorganisms that are present within the given sample. This can be achieved for all known microbes, where the DNA sequence specific for a certain species is known.</p>
<p>For that we try to <strong>identify the taxon</strong> to which each individual read belongs.</p>
<p>For metagenomic data analysis we start with sequences derived from DNA fragments that are isolated from the sample of interest. Ideally, the sequences from all microbes in the sample are present. The underlying idea of taxonomic assignment is to compare the DNA sequences found in the sample (reads) to DNA sequences of a database. When a read matches a database DNA sequence of a known microbe, we can derive a list with microbes present in the sample.</p>
<p>When talking about taxonomic assignment or taxonomic classification, most of the time we actually talk about two methods, that in practice are often used interchangeably:
- <strong>taxonomic binning</strong>: the clustering of individual sequence reads based on similarities criteria and assignation of clusters to reference taxa
- <strong>taxonomic profiling</strong>: classification of individual reads to reference taxa to extract the relative abundances of the different taxa</p>
<p>The reads can be obtained from <strong>amplicon sequencing</strong>  (e.g. 16S, 18S, ITS), where only specific gene or gene fragments are targeted (using specific primers) or <strong>shotgun metagenomic sequencing</strong>, where all the accessible DNA of a mixed community is amplified (using random primers).
This tutorial focuses on reads obtained from shotgun metagenomic sequencing.</p>
<h2 id="taxonomic-profiling">Taxonomic profiling<a class="headerlink" href="#taxonomic-profiling" title="Permanent link">#</a></h2>
<p>Tools for taxonomic profiling can be divided into three groups. Nevertheless, all of them require a pre-computed database based on previously sequenced microbial DNA or protein sequences.
1. <strong>DNA-to-DNA</strong>: comparison of sequencing reads with genomic databases of DNA sequences with tools like Kraken ((Wood2014 ))
2. <strong>DNA-to-Protein</strong> : comparison of sequencing reads with protein databases (more computationally intensive because all six frames of potential DNA-to amino acid translations need to be analyzed) with tools like DIAMOND)
3. <strong>Marker based</strong>: searching for marker genes (e.g. 16S rRNA sequence) in reads, which is quick, but introduces bias, with tools like MetaPhlAn ((blanco2023extending ))</p>
<p>The comparison of reads to database sequences can be done in different ways, leading to three different types of taxonomic assignment:</p>
<ul>
<li><strong>Genome based</strong> approach</li>
</ul>
<p>Reads are aligned to reference genomes. Considering the coverage and breadth, genomes are used to measure genome abundance. Furthermore, genes can be analyzed in genomic context. Advantages of this method are the high detection accuracy, that the unclassified percentage is known, that all SNVs can be detected and that high-resolution genomic comparisons are possible. This method takes medium compute cost.</p>
<ul>
<li><strong>Gene based</strong> approach</li>
</ul>
<p>Reads are aligned to reference genes. Next, marker genes are used to estimate species abundance. Furthermore, genes can be analyzed in isolation for presence or absence in a specific condition. The major advantage is the detection of the pangenome (entire set of genes within a species). Major disadvantages are the high compute cost, low detection accuracy and that the unclassified percentage is unknown. At least intragenic SNVs can be detected and low-resolution genomic comparison is possible.</p>
<ul>
<li><strong>k-mer based</strong> approach</li>
</ul>
<p>Databases as well as the samples DNA are broken into strings of length <script type="math/tex; mode=display">k</script> for comparison. From all the genomes in the database, where a specific k-mer is found, a lowest common ancestor (LCA) tree is derived and the abundance of k-mers within the tree is counted. This is the basis for a root-to-leaf path calculation, where the path with the highest score is used for classification of the sample. By counting the abundance of k-mers, also an estimation of relative abundance of taxa is possible. The major advantage of k-mer based analysis is the low compute cost. Major disadvantages are the low detection accuracy, that the unclassified percentage is unknown and that there is no gene detection, no SNVs detection and no genomic comparison possible. An example for a k-mer based analysis tool is Kraken, which will be used in this tutorial.</p>
<p>After this theoretical introduction, let's now get hands on analyzing an actual dataset!</p>
<h2 id="background-on-data">Background on data<a class="headerlink" href="#background-on-data" title="Permanent link">#</a></h2>
<p>The dataset we will use for this tutorial comes from an oasis in the Mexican desert called Cuatro Ciénegas ((Okie.2020 )). The researchers were interested in genomic traits that affect the rates and costs of biochemical information processing within cells. They performed a whole-ecosystem experiment, thus fertilizing the pond to achieve nutrient enriched conditions.</p>
<p>Here we will use 2 datasets:
- <code>JP4D</code>: a microbiome sample collected from the Lagunita Fertilized Pond
- <code>JC1A</code>: a <strong>control</strong> samples from a control mesocosm.</p>
<p>The datasets differ in size, but according to the authors this doesn't matter for their analysis of genomic traits. Also, they underline that differences between the two samples reflect trait-mediated ecological dynamics instead of microevolutionary changes as the duration of the experiment was only 32 days. This means that depending on available nutrients, specific lineages within the pond grow more successfully than others because of their genomic traits.</p>
<p>The datafiles are named according to the first four characters of the filenames.
It is a collection of paired-end data with R1 being the forward reads and R2 being the reverse reads. Additionally, the reads have been trimmed using <strong>cutadapt</strong> as explained in the <a href="[topics/sequence-analysis/tutorials/quality-control/tutorial.md ]">Quality control tutorial</a>.</p>
<blockquote>
<p>Agenda</p>
<p>In this tutorial, we will cover:</p>
<ol>
<li toc="toc">TOC</li>
</ol>
</blockquote>
<div class="admonition info">
<p class="admonition-title">Info</p>
</div>
<h1 id="prepare-galaxy-and-data">Prepare Galaxy and data<a class="headerlink" href="#prepare-galaxy-and-data" title="Permanent link">#</a></h1>
<p>Any analysis should get its own Galaxy history. So let's start by creating a new one:</p>
<blockquote>
<p>Hands-on: Data upload</p>
<ol>
<li>
<p>Create a new history for this analysis</p>
</li>
<li>
<p>Rename the history</p>
</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p>Now, we need to import the data</p>
<blockquote>
<p>Hands-on: Import datasets</p>
<ol>
<li>Import the following samples via link from <a href="{{ no such element: mkdocs.structure.pages.Page object['zenodo_link'] }}">Zenodo</a> or Galaxy shared data libraries:</li>
</ol>
<div class="highlight"><pre><span></span><code>{{ no such element: mkdocs.structure.pages.Page object[&#39;zenodo_link&#39;] }}/files/JC1A_R1.fastqsanger.gz
{{ no such element: mkdocs.structure.pages.Page object[&#39;zenodo_link&#39;] }}/files/JC1A_R2.fastqsanger.gz
{{ no such element: mkdocs.structure.pages.Page object[&#39;zenodo_link&#39;] }}/files/JP4D_R1.fastqsanger.gz
{{ no such element: mkdocs.structure.pages.Page object[&#39;zenodo_link&#39;] }}/files/JP4D_R2.fastqsanger.gz
</code></pre></div>
<ol>
<li>Create a paired collection.</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<h1 id="k-mer-based-taxonomic-assignment-with-kraken2">k-mer based taxonomic assignment with Kraken2<a class="headerlink" href="#k-mer-based-taxonomic-assignment-with-kraken2" title="Permanent link">#</a></h1>
<p>Our input data is the DNA reads of microbes present at Cuatro Ciénegas.</p>
<p>To find out which microorganisms are present, we will compare the reads of the sample to a reference database, i.e. sequences of known microorganisms stored in a database, using <strong>Kraken2</strong> ((wood2019improved )).</p>
<p>For this tutorial, we will use the PlusPF database which contains the Standard (archaea, bacteria, viral, plasmid, human, UniVec_Core), protozoa and fungi data.</p>
<blockquote>
<p>Details: What is in the PlusPF database</p>
<table>
<thead>
<tr>
<th>Database</th>
<th>Origin</th>
</tr>
</thead>
<tbody>
<tr>
<td>Archaea</td>
<td>RefSeq complete archaeal genomes/proteins</td>
</tr>
<tr>
<td>Bacteria</td>
<td>RefSeq complete bacterial genomes/proteins</td>
</tr>
<tr>
<td>Plasmid</td>
<td>RefSeq plasmid nucleotide/protein sequences</td>
</tr>
<tr>
<td>Viral</td>
<td>RefSeq complete viral genomes/proteins</td>
</tr>
<tr>
<td>Human</td>
<td>GRCh38 human genome/proteins</td>
</tr>
<tr>
<td>Fungi</td>
<td>RefSeq complete fungal genomes/proteins</td>
</tr>
<tr>
<td>Plant</td>
<td>RefSeq complete plant genomes/proteins</td>
</tr>
<tr>
<td>Protozoa</td>
<td>RefSeq complete protozoan genomes/proteins</td>
</tr>
<tr>
<td>UniVec_Core</td>
<td>A subset of UniVec, NCBI-supplied database of vector, adapter, linker, and primer sequences that may be contaminating sequencing projects and/or assemblies, chosen to minimize false positive hits to the vector database</td>
</tr>
</tbody>
</table>
<p>The databases have been prepared for Kraken2 by Ben Leagmead and <a href="https://benlangmead.github.io/aws-indexes/k2">details can found on his page</a>.</p>
</blockquote>
<details class="note">
<summary>Note</summary>
</details>
<blockquote>
<p>Hands-on: Assign taxonomic labels with Kraken2</p>
<ol>
<li><strong>Kraken2</strong> – <a href="toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.3+galaxy1">Tool link</a> with the following parameters:</li>
<li><em>"Single or paired reads"</em>: <code>Paired Collection</code><ul>
<li><em>"Collection of paired reads"</em>: Input paired collection</li>
</ul>
</li>
<li>
<p><em>"Confidence"</em>: <code>0.1</code></p>
<p>A confidence score of 0.1 means that at least 10% of the k-mers should match entries in the database. This value can be reduced if a less restrictive taxonomic assignation is desired.</p>
</li>
<li>
<p>In <em>"Create Report"</em>:</p>
<ul>
<li><em>"Print a report with aggregrate counts/clade to file"</em>: <code>Yes</code></li>
</ul>
</li>
<li><em>"Select a Kraken2 database"</em>: most recent <code>Prebuilt Refseq indexes: PlusPF</code>
</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p><strong>Kraken2</strong> will create two outputs for each dataset</p>
<ul>
<li>
<p><strong>Classification</strong>: tabular files with one line for each sequence classified by Kraken and 5 columns:</p>
</li>
<li>
<p><code>C</code>/<code>U</code>: a one letter indicating if the sequence classified or unclassified</p>
</li>
<li>Sequence ID as in the input file</li>
<li>NCBI taxonomy ID assigned to the sequence, or 0 if unclassified</li>
<li>Length of sequence in bp (<code>read1|read2</code> for paired reads)</li>
<li>
<p>A space-delimited list indicating the lowest common ancestor (LCA) mapping of each k-mer in the sequence</p>
<p>For example, <code>562:13 561:4 A:31 0:1 562:3</code> would indicate that:
  1. The first 13 k-mers mapped to taxonomy ID #562
  2. The next 4 k-mers mapped to taxonomy ID #561
  3. The next 31 k-mers contained an ambiguous nucleotide
  4. The next k-mer was not in the database
  5. The last 3 k-mers mapped to taxonomy ID #562</p>
<p><code>|:|</code> indicates end of first read, start of second read for paired reads</p>
</li>
</ul>
<p>For JC1A:</p>
<div class="highlight"><pre><span></span><code>Column 1 Column 2    Column 3    Column 4    Column 5
U    MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:13417:1998    0   151|190     A:17 0:15 2055:5 0:1 2220095:5 0:74 |:| 0:3 A:53 2:2 0:32 204455:1 2823043:5 0:60
U    MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:15782:2187    0   169|173     0:101 37329:1 0:33 |:| 0:10 2751189:5 0:30 1883:2 0:39 2609255:5 0:48
U    MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:11745:2196    0   235|214     0:173 2282523:5 2746321:2 0:21 |:| 0:65 2746321:2 2282523:5 0:108
U    MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:18358:2213    0   251|251     0:35 281093:5 0:3 651822:5 0:145 106591:3 0:21 |:| 0:64 106591:3 0:145 651822:5
U    MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:14892:2226    0   68|59   0:34 |:| 0:25
U    MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:18764:2247    0   146|146     0:112 |:| 0:112
C    MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:12147:2252    9606    220|220     9606:148 0:19 9606:19 |:| 9606:19 0:19 9606:148
</code></pre></div>
<blockquote>
<p>Question</p>
<p>For JC1A sample
1. Is the first sequence in the file classified or unclassified?
2. What is the taxonomy ID assigned to the first classified sequence?
3. What is the corresponding taxon?</p>
<blockquote>
<p>Solution
1. unclassified
2. 9606, for the line 7
3. 9606 corresponds to Homo sapiens when looking at NCBI.</p>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
<p>??? question</p>
</blockquote>
<ul>
<li>
<p><strong>Report</strong>: tabular files with one line per taxon and 6 columns or fields</p>
</li>
<li>
<p>Percentage of fragments covered by the clade rooted at this taxon</p>
</li>
<li>Number of fragments covered by the clade rooted at this taxon</li>
<li>Number of fragments assigned directly to this taxon</li>
<li>
<p>A rank code, indicating</p>
<ul>
<li>(U)nclassified</li>
<li>(R)oot</li>
<li>(D)omain</li>
<li>(K)ingdom</li>
<li>(P)hylum</li>
<li>(C)lass</li>
<li>(O)rder</li>
<li>(F)amily</li>
<li>(G)enus, or</li>
<li>(S)pecies</li>
</ul>
<p>Taxa that are not at any of these 10 ranks have a rank code that is formed by using the rank code of the closest ancestor rank with a number indicating the distance from that rank. E.g., <code>G2</code> is a rank code indicating a taxon is between genus and species and the grandparent taxon is at the genus rank.</p>
</li>
<li>
<p>NCBI taxonomic ID number</p>
</li>
<li>Indented scientific name</li>
</ul>
<div class="highlight"><pre><span></span><code>Column 1 Column 2    Column 3    Column 4    Column 5    Column 6
76.85    105397  105397  U   0   unclassified
23.15    31742   1197    R   1   root
22.20    30450   312     R1  131567  cellular organisms
12.58    17256   3768    D   2   Bacteria
8.77     12028   2868    P   1224    Proteobacteria
4.94     6779    3494    C   28211   Alphaproteobacteria
1.30     1782    1085    O   204455  Rhodobacterales
0.43     593     461     F   31989   Rhodobacteraceae
0.05     74  53  G   265     Paracoccus
</code></pre></div>
<blockquote>
<p>Question</p>
<ol>
<li>What are the percentage on unclassified for JC1A and JP4D?</li>
<li>What are the kindgoms found for JC1A and JP4D?</li>
<li>Where might the eukaryotic DNA come from?</li>
<li>How is the diversity of Proteobacteria in JC1A and JP4D?</li>
</ol>
<blockquote>
<p>Solution</p>
<ol>
<li>77% for JC1A and 90% for JP4D</li>
<li>Kindgoms:</li>
<li>JC1A: 13% Bacteria, 9% Eukaryota, 0.03% Virus</li>
<li>JP4D: 9% Bacteria, 0.7% Eukaryota</li>
<li>It seems to be human contamination</li>
<li>JC1A seems to have a big diversity of classes and species of Proteobacteria. JP4D seems more dominated by Aphaproteobacteria.</li>
</ol>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
<p>??? question</p>
</blockquote>
<p>Getting an overview of the assignation is not straightforward with the <strong>Kraken2</strong> outputs directly. We can use visualisation tools for that.</p>
<p>A "simple and worthwile addition to Kraken for better abundance estimates" ((Ye.2019 )) is called <strong>Bracken</strong> (Bayesian Reestimation of Abundance after Classification with Kraken). Instead of only using proportions of classified reads, it takes a probabilistic approach to generate final abundance profiles. It works by re-distributing reads in the taxonomic tree: "Reads assigned to nodes above the species level are distributed down to the species nodes, while reads assigned at the strain level are re-distributed upward to their parent species" ((Lu.2017 )).</p>
<blockquote>
<p>Hands-on: Estimate species abundance with Bracken</p>
<ol>
<li>
<p><strong>Estimate Abundance at Taxonomic Level</strong> – <a href="toolshed.g2.bx.psu.edu/repos/iuc/bracken/est_abundance/3.1+galaxy0">Tool link</a> with the following parameters:</p>
<ul>
<li><em>"Kraken report file"</em>: <strong>Report</strong> output of <strong>Kraken</strong></li>
<li><em>"Select a kmer distribution"</em>: <code>PlusPF</code>, same as for Kraken</li>
</ul>
<p>It is important to choose the same database that you also chose for Kraken2</p>
<ul>
<li><em>"Level"</em>: <code>Species</code></li>
<li><em>"Produce Kraken-Style Bracken report"</em>: <code>yes</code>
</li>
</ul>
</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<h1 id="visualization-of-taxonomic-assignment">Visualization of taxonomic assignment<a class="headerlink" href="#visualization-of-taxonomic-assignment" title="Permanent link">#</a></h1>
<p>Once we have assigned the corresponding taxa to each sequence, the next step is to properly visualize the data. There are several tools for that:
- <strong>Krona</strong> ((Ondov.2011 ))
- <strong>Phinch</strong> ((Bik.2014 ))
- <strong>Pavian</strong> ((Breitwieser.2020 ))</p>
<h2 id="visualisation-using-krona">Visualisation using Krona<a class="headerlink" href="#visualisation-using-krona" title="Permanent link">#</a></h2>
<p><strong>Krona</strong> creates an interactive HTML file allowing hierarchical data to be explored with zooming, multi-layered pie charts. With this tool, we can easily visualize the composition of the bacterial communities and compare how the populations of microorganisms are modified according to the conditions of the environment.</p>
<p>Kraken outputs can not be given directly to <strong>Krona</strong>, they first need to be converted.</p>
<p><strong>Krakentools</strong> ((Lu.2017 )) is a suite of tools to work on Kraken outputs. It include a tool designed to translate results of the Kraken metagenomic classifier to the full representation of NCBI taxonomy. The output of this tool can be directly visualized by the Krona tool.</p>
<blockquote>
<p>Hands-on: Convert Kraken report file</p>
<ol>
<li><strong>Krakentools: Convert kraken report file</strong> – <a href="toolshed.g2.bx.psu.edu/repos/iuc/krakentools_kreport2krona/krakentools_kreport2krona/1.2+galaxy2">Tool link</a> with the following parameters:</li>
<li>
<p><em>"Kraken report file"</em>: <strong>Report</strong> collection of <strong>Kraken</strong></p>
</li>
<li>
<p>Inspect the generated output for JC1A</p>
</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<blockquote>
<p>Question</p>
<div class="highlight"><pre><span></span><code>3869  k__Bacteria
2868  k__Bacteria     p__Proteobacteria
3494  k__Bacteria     p__Proteobacteria   c__Alphaproteobacteria
1085  k__Bacteria     p__Proteobacteria   c__Alphaproteobacteria  o__Rhodobacterales
461   k__Bacteria     p__Proteobacteria   c__Alphaproteobacteria  o__Rhodobacterales  f__Rhodobacteraceae
53    k__Bacteria     p__Proteobacteria   c__Alphaproteobacteria  o__Rhodobacterales  f__Rhodobacteraceae     g__Paracoccus
10    k__Bacteria     p__Proteobacteria   c__Alphaproteobacteria  o__Rhodobacterales  f__Rhodobacteraceae     g__Paracoccus   s__Paracoccus_pantotrophus
6     k__Bacteria     p__Proteobacteria   c__Alphaproteobacteria  o__Rhodobacterales  f__Rhodobacteraceae     g__Paracoccus   s__Paracoccus_sanguinis
4     k__Bacteria     p__Proteobacteria   c__Alphaproteobacteria  o__Rhodobacterales  f__Rhodobacteraceae     g__Paracoccus   s__Paracoccus_sp._AK26
1     k__Bacteria     p__Proteobacteria   c__Alphaproteobacteria  o__Rhodobacterales  f__Rhodobacteraceae     g__Paracoccus   s__Paracoccus_sp._MA
</code></pre></div>
<ol>
<li>What are the different columns?</li>
<li>What are the lines?</li>
</ol>
<blockquote>
<p>Solution</p>
<ol>
<li>Column 1 seems to correspond to the number of fragments covered by a taxon, the columns after represent the different taxonomic level (from kingdom to species)</li>
<li>A line is a taxon with its hierarchy and the number of reads assigned to it</li>
</ol>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
</blockquote>
<details class="question">
<summary>Question</summary>
</details>
<p>Let's now run <strong>Krona</strong></p>
<blockquote>
<p>Hands-on: Generate Krona visualisation
1. <strong>Krona pie chart</strong> – <a href="toolshed.g2.bx.psu.edu/repos/crs4/taxonomy_krona_chart/taxonomy_krona_chart/2.7.1+galaxy0">Tool link</a> with the following parameters:
   - <em>"Type of input data"</em>: <code>Tabular</code>
   -  <em>"Input file"</em>: output of <strong>Krakentools</strong></p>
<ol>
<li>Inspect the generated file</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p><img alt="Krona chart with multi-layered pie chart representing the community profile with in the center the higher taxonomy levels (i.e. domain) and on the exterior the more detailed ones (i.e. species)" src="./images/krona-kraken.png" /></p>
<blockquote>
<p>Question</p>
<ol>
<li>What are the percentage on unclassified for JC1A and JP4D?</li>
<li>What are the kindgoms found for JC1A and JP4D?</li>
<li>Where might the eukaryotic DNA come from?</li>
<li>How is the diversity of Proteobacteria in JC1A and JP4D?</li>
</ol>
<blockquote>
<p>Solution</p>
<ol>
<li>78% for JC1A and 90% for JP4D</li>
<li>Kindgoms:</li>
<li>JC1A: 13% Bacteria, 10% Eukaryota, 0.03% Virus</li>
<li>JP4D: 10% Bacteria, 0.7% Eukaryota</li>
<li>It seems to be human contamination</li>
<li>JC1A seems to have a big diversity of classes and species of Proteobacteria. JP4D seems more dominated by Aphaproteobacteria.</li>
</ol>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
</blockquote>
<details class="question">
<summary>Question</summary>
</details>
<h2 id="visualization-using-pavian">Visualization using Pavian<a class="headerlink" href="#visualization-using-pavian" title="Permanent link">#</a></h2>
<p><strong>Pavian</strong> (pathogen visualization and more) ((Breitwieser.2020 )) is an interactive visualization tool for metagenomic data. It was developed for the clinical metagenomic problem to find a disease-causing pathogen in a patient sample, but it is useful to analyze and visualize any kind of metagenomics data.</p>
<blockquote>
<p>Hands-on: Launch Pavian
1. <strong>Pavian</strong> – <a href="interactive_tool_pavian">Tool link</a> with the following paramters:
    -  <em>"Kraken and MetaPhlAn-style reports"</em>: <strong>Report</strong> collection of <strong>Kraken</strong>
</p>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p><strong>Pavian</strong> runs a Galaxy Interactive tool. You can access it when it become orange.</p>
<blockquote>
<p>Hands-on: Interact with Pavian</p>
<ol>
<li>
<p>Open <strong>Pavian</strong></p>
</li>
<li>
<p>Import data</p>
</li>
<li>Click on <code>Use data on server</code></li>
<li>Select both samples</li>
<li>Click on <code>Read selected directories</code></li>
<li>
<p>Check you have a table in <code>Available sample sets</code> looks like</p>
<table>
<thead>
<tr>
<th>X</th>
<th>FormatOK</th>
<th>Include</th>
<th>Name</th>
<th>ReportFile</th>
<th>ReportFilePath</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>X</td>
<td>X</td>
<td>JP4AD</td>
<td>JP4AD</td>
<td>/home/shiny//JP4AD</td>
</tr>
<tr>
<td>2</td>
<td>X</td>
<td>X</td>
<td>JC1A</td>
<td>JC1A</td>
<td>/home/shiny//JC1A</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Click on <code>Save table</code></p>
</li>
<li>
<p>Click on <code>Results Overview</code> in the left panel
</p>
</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p>This page shows the summary of the classifications in the selected sample set:</p>
<p><img alt="Screenshot of a table with 2 rows (JP4A and JC1A) and columns: Name, Number of raw reads, Classified reads, Chordate reads, Artificial reads, Unclassified reads, Microbial reads, Bacterial reads, Viral reads, Fungal reads, Protozoan reads. The cells have a barchart that shows the relation of the cell value to other cell values in the same category" src="./images/pavian-kraken-results-overview.png" /></p>
<blockquote>
<p>Question</p>
<ol>
<li>Does both sample have same size?</li>
<li>What are the percentage of classified reads for JC1A and JP4D?</li>
<li>Are the percentage of bacterial reads similar?</li>
</ol>
<blockquote>
<p>Solution</p>
<ol>
<li>JP4D has much more reads than JC1A</li>
<li>10.2% for JP4D and 23.1% for JC1A</li>
<li>12.6% for JC1A and 9.22% for JP4D. So similar magnitude orders</li>
</ol>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
</blockquote>
<details class="question">
<summary>Question</summary>
</details>
<p>Let's now inspect assignements to reads per sample.</p>
<blockquote>
<p>Hands-on: Inspect samples with Pavian</p>
<ol>
<li>Click on <code>Sample</code> in the left panel</li>
<li>Select <code>JC1A</code> in the <code>Select sample</code> drop-down on the top</li>
</ol>
<p>The first view gives a Sankey diagram for one sample:</p>
<p><img alt="Sankey plot with taxonomy hierarchy from domain on the left to species on the right" src="./images/pavian-kraken-sankey-JC1A.png" /></p>
<blockquote>
<p>Question</p>
<ol>
<li>What is a Sankey diagram?</li>
<li>What are the different set of values represented as the horizontal axis?</li>
</ol>
<blockquote>
<p>Solution</p>
<ol>
<li>A sankey diagram is a visualization used to depict a flow from one set of values to another</li>
<li>The taxonomy hierarchy from domain on the left to species on the right</li>
</ol>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
<p>??? question</p>
</blockquote>
<ol>
<li>Click on <code>Proteobacteria</code> in the Sankey plot</li>
<li>Inspect the created graph on the right</li>
</ol>
<p><img alt="Bar plot with the number of reads across all samples for Proteobacteria. JP4A bar is much higher than JC1A one. The turqoise bar shows the number of reads that are identified at the specific taxon; the orange bar shows the number of reads identified at children of the specified taxon." src="./images/pavian-kraken-proteobacteria.png" /></p>
<blockquote>
<p>Question</p>
<ol>
<li>Are the number of reads assigned to Proteobacteria similar for both samples?</li>
<li>Why?</li>
</ol>
<blockquote>
<p>Solution</p>
<ol>
<li>JP4A has many more reads assigned to Proteobacteria than JC1A</li>
<li>JP4A has many more reads initialls</li>
</ol>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
<p>??? question</p>
</blockquote>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p>We would like now to compare both samples.</p>
<blockquote>
<p>Hands-on: Inspect samples with Pavian</p>
<ol>
<li>Click on <code>Comparison</code> in the left panel</li>
<li>Select <code>%</code>  and unclick <code>Reads</code> in the blue area drop-down on the top</li>
<li>Click on <code>Domain</code> green button</li>
</ol>
<p><img alt="Screenshot of a table with 4 rows (Bacteria, Eukaryota, Archaea, Viruses) and / columns (Name, Rank, TID, Max, JP4A, JC1A, Lineage)" src="./images/pavian-kraken-comparison-domain.png" /></p>
<blockquote>
<p>Question</p>
<p>Is there similar proportion of Bacteria in both samples?</p>
<blockquote>
<p>Solution</p>
<p>JP4D has much higher proportion of Bacteria (&gt; 93%&gt;) than JC1A (57%), which contains quite a lot of Eukaryote</p>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
<p>??? question</p>
</blockquote>
<ol>
<li>Select <code>Homo sapiens</code> in the <code>Filter taxa</code> box below the green buttons</li>
</ol>
<blockquote>
<p>Question</p>
<p>Is there similar proportion of Bacteria in both samples?</p>
<blockquote>
<p>Solution</p>
<p>After human filtering, both samples have similar proportion of Bacteria</p>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
<p>??? question</p>
</blockquote>
<ol>
<li>Click on <code>Class</code> green button</li>
</ol>
<blockquote>
<p>Question</p>
<ol>
<li>How are the diversities of classes in both samples?</li>
<li>What could it biologically mean given that JC1A is a control and JP4D a sample from fertilized pond?</li>
</ol>
<blockquote>
<p>Solution</p>
<ol>
<li>JP4D seems highly dominated by a Alphaproteobacteria class. JC1A has also a majority of Alphaproteobacteria, but also significant proportions of Betaproteobacteria, Gammaproteobacteria, Flavobacteria, Actinomycetia</li>
<li>Alphaproteobacteria seems to have a survival advantage in the new environment. According to the authors this correlates with specific genomic traits that enable them to cope better with high nutrient availability.</li>
</ol>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
<p>??? question
</p>
</blockquote>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p>Once you are done with Pavian, you should delete it in your history so the corresponding job is killed.</p>
<blockquote>
<p>Details: Visualize the taxonomical classification with Phinch</p>
<p><strong>Phinch</strong> ((Bik.2014 )) is another tools to visualize large biological datasets like our taxonomic classification. Taxonomy Bar Charts, Bubble Charts, Sankey Diagrams, Donut Partitions and Attributes Column Chart can be generated using this tool.</p>
<p>As a first step, we need to convert the Kraken output file into a kraken-biom file to make it accessible for Phinch. For this, we need to add a metadata file, provided on <a href="{{ no such element: mkdocs.structure.pages.Page object['zenodo_link'] }}/files/metadata.tabular">Zenodo</a>.
When generating a metadata file for your own data, you can take this as an example and apply the <a href="http://qiime.org/documentation/file_formats.html">general guidelines</a>.</p>
<blockquote>
<p>Hands-on: Phinch
1. Import the metadata tabular from <a href="{{ no such element: mkdocs.structure.pages.Page object['zenodo_link'] }}">Zenodo</a> or Galaxy shared data libraries:</p>
<div class="highlight"><pre><span></span><code>{{ no such element: mkdocs.structure.pages.Page object[&#39;zenodo_link&#39;] }}/files/metadata.tabular
</code></pre></div>
<ol>
<li>Use <strong>Kraken-biom</strong> – <a href="toolshed.g2.bx.psu.edu/repos/iuc/kraken_biom/kraken_biom/1.2.0+galaxy1">Tool link</a> to convert Kraken2 report into the correct format for phinch with the following parameters.</li>
<li><em>"Input"</em>: <strong>Report</strong> output of <strong>Kraken2</strong></li>
<li><em>"Sample Metadata file"</em>: Metadata tabular</li>
<li>
<p><em>"Output format"</em>: <code>JSON</code></p>
</li>
<li>
<p><strong>Phinch Visualisation</strong> – <a href="interactive_tool_phinch">Tool link</a> with the following paramters:</p>
</li>
<li><em>"Input"</em>: <code>Kraken-biom output file</code></li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p><strong>Phinch</strong> runs a Galaxy Interactive tool. You can access it when it become orange.</p>
<blockquote>
<p>Hands-on: Interact with Phinch</p>
<ol>
<li>Open <strong>Phinch</strong></li>
</ol>
<p>The first pages shows an overview of your samples. Here, you have the possibility to further filter your data, for example by date or location, depending on which information you provided in your metadata file.</p>
<blockquote>
<p>Question</p>
<ol>
<li>How many sequence reads do the samples contain?</li>
</ol>
<blockquote>
<p>Solution</p>
<ol>
<li>JC1A (Phinch name: 0) contains 56008 reads, while JP4D (Phinch name: 1) contains 242438 reads</li>
</ol>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
<p>??? question</p>
</blockquote>
<ol>
<li>Click on <code>Proceed to gallery</code> to see an overview of all visualization options.</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p>Let's have a look at the <strong>taxonomy bar chart</strong>. Here, you can see the abundance of different taxa depicted in different colors in your samples. On top of the chart you can select which rank is supposed to be shown in the chart.  You can also change the display options to for example switch between value und percentage.</p>
<blockquote>
<p>Question</p>
<ol>
<li>What information can you get from hovering over a sample?</li>
<li>How many percent of the sample reads are bacteria and how many are eukaryota?</li>
</ol>
<blockquote>
<p>Solution</p>
<ol>
<li>the taxon’s name and the taxonomy occurrence in the sample</li>
<li>choose kingdom and hover over the bars to find "taxonomy occurence in this sample":</li>
<li>Sample 0: 75,65 % bacteria; 24,51 % eukaryota</li>
<li>Sample 1: 92,70 % bacteria; 6,87 % eukaryota</li>
</ol>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
</blockquote>
<details class="question">
<summary>Question</summary>
</details>
<p>Let's go back to the gallery and choose the <strong>bubble chart</strong>. Here, you can find the distribution of taxa across the whole dataset at the rank that you can choose above the chart. When hovering over the bubbles, you get additional information concerning the taxon.</p>
<blockquote>
<p>Question</p>
<ol>
<li>Which is the most abundant Class?</li>
<li>How many reads are found in both samples?</li>
</ol>
<blockquote>
<p>Solution</p>
<p>To order the bubbles according to their size you can choose the <code>list</code> option shown right next to the taxonomy level. Clicking on one bubble gives you the direct comparison of the distribution of this taxon in the different samples.
1. The most abundant Class is Alphaproteobacteria
2. With 18.114 reads in Sample 0 and 153.230 reads in sample 1</p>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
</blockquote>
<details class="question">
<summary>Question</summary>
</details>
<p>Another displaying option is the <strong>Sankey diagram</strong>, that is depicting the abundance of taxonomies as a flow chart. Again, you can choose the taxonomy level that you want to show in your diagram. When clicking on one bar of the diagram, this part is enlarged for better view.</p>
<p>The <strong>donut partition</strong> summarizes the microbial community according to non-numerical attributes. In the drop-down menu at the top right corner, you can switch between the different attributes provided in the metadata file. In our case, you can for example choose the 'environmental medium' to see the difference between sediment and water (It doesn't really make a lot of sense in our very simple dataset, as this will show the same result as sorting them by sample 0 and 1, but if attributes change across different samples this might be an interesting visualization option). When clicking on one part of the donut you will also find the distribution of the taxon across the samples. On the right hand side you can additionally choose if you’d like to have dynamic y axis or prefer standard y axis to compare different donuts with each other.</p>
<p>The <strong>attributes column chart</strong> summarizes the microbial community according to numerical attributes. In the drop-down menu at the top right corner, you can switch between the different attributes provided in the metadata file. In our case, you can for example choose the 'geographic location' to (again, it doesn't really make a lot of sense in our very simple dataset, as this will show the same result as sorting them by sample 0 and 1, but if attributes change across different samples this might be an interesting visualization option).</p>
<p>Once you are done with Phinch, you should delete it in your history so the corresponding job is killed.</p>
</blockquote>
<details class="note">
<summary>Note</summary>
</details>
<h1 id="choosing-the-right-tool">Choosing the right tool<a class="headerlink" href="#choosing-the-right-tool" title="Permanent link">#</a></h1>
<p>When it comes to taxonomic assignment while analyzing metagenomic data, <strong>Kraken2</strong> is not the only tool available. Several papers do benchmarking of different tools ((Meyer.2022 ),(Sczyrba.2017 ),(Ye.2019 )).</p>
<blockquote>
<p>Details: Benchmarking taxonomic classification tools</p>
<p>The benchmarking papers present different methods for comparing the available tools:
- The <strong>CAMI challenge</strong> is based on results of different labs that each used the CAMI dataset to perform their analysis on and send it back to the authors.
- (Ye.2019 ) performed all the analysis themselves.</p>
<p>Additionally, the datasets used for both benchmarking approaches differ:
- <strong>CAMI</strong>: only ~30%-40% of reads are simulated from known taxa while the rest of the reads are from novel taxa, plasmids or simulated evolved strains.
- (Ye.2019 ) used International Metagenomics and Microbiome Standards Alliance (IMMSA) datasets, wherein the taxa are described better.</p>
<p>When benchmarking different classification tools, several metrics are used to compare their performance:
1. <strong>Precision</strong>: proportion of true positive species identified in the sample divided by number of total species identified by the method.
2. <strong>Recall</strong>: proportion of true positive species divided by the number of distinct species actually in the sample.
3. Precision-recall curve: each point represents the precision and recall scores at a specific abundance threshold, the <strong>area under the precision-recall curve (AUPR)</strong>
4. <strong>L2 distance</strong>: representation of abundance profiles → how accurately the abundance of each species or genera in the resulting classification reflects the abundance of each species in the original biological sample (“ground truth”)</p>
<p>When it comes to taxonomic profiling, thus investigating the abundance of specific taxa, the biggest problem is the abundance bias. It is introduced during isolation of DNA (which might work for some organisms better then for others) and by PCR duplicates during PCR amplification.</p>
</blockquote>
<details class="note">
<summary>Note</summary>
</details>
<blockquote>
<p>Details: Profiling tools</p>
<p>Profilers, which are tools that investigate relative abundances of taxa within a dataset, fall into three groups depending on their performance:
1. Profilers, that correctly predict relative abundances
2. Precise profilers (suitable, when many false positives would increase cost and effort in downstream analysis)
3. Profilers with high recall (suitable for pathogen detection, when the failure of detecting an organism can have severe negative consequences)</p>
<p>However, some characteristics are common to all profilers:
- Most profilers only perform well until the family level
- Drastic decrease in performance between family and genus level, while little change between order and family level
- Poorer performance of all profilers on CAMI datasets compared to International Metagenomics and Microbiome Standards Alliance (IMMSA)
- Fidelity of abundance estimates decreases notably when viruses and plasmids were present
- High numbers of false positive calls at low abundance
- Taxonomic profilers vs profiles from taxonomic binning:
Precision and recall of the taxonomic binners were comparable to that of the profilers;
abundance estimation at higher ranks was more problematic for the binners</p>
</blockquote>
<details class="note">
<summary>Note</summary>
</details>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Approach</th>
<th>Available in Galaxy</th>
<th>CAMI challenge</th>
<th>(Ye.2019 )</th>
</tr>
</thead>
<tbody>
<tr>
<td>mOTUs</td>
<td></td>
<td>No</td>
<td>Most memory efficient</td>
<td></td>
</tr>
<tr>
<td>MetaPhlAn</td>
<td>Marker genes</td>
<td>Yes</td>
<td></td>
<td>Recommended for low computational requirements (&lt; 2 Gb of memory)</td>
</tr>
<tr>
<td>DUDes</td>
<td></td>
<td>No</td>
<td></td>
<td></td>
</tr>
<tr>
<td>FOCUS</td>
<td></td>
<td>No</td>
<td>Fast, most memory efficient</td>
<td></td>
</tr>
<tr>
<td>Bracken</td>
<td>k-mer</td>
<td>Yes</td>
<td>Fast</td>
<td></td>
</tr>
<tr>
<td>Kraken</td>
<td>k-mer</td>
<td>Yes</td>
<td>Fastest; most memory efficient</td>
<td>Good performance metrics; very fast on large numbers of samples; allow custom databases when high amounts of memory (&gt;100 Gb) are available</td>
</tr>
</tbody>
</table>
<h1 id="marker-gene-based-approach-using-metaphlan">Marker gene based approach using MetaPhlAn<a class="headerlink" href="#marker-gene-based-approach-using-metaphlan" title="Permanent link">#</a></h1>
<p>In this tutorial, we follow second approach using <strong>MetaPhlAn</strong> ((truong2015metaphlan2 )). MetaPhlAn is a computational tool for profiling the composition of microbial communities (Bacteria, Archaea and Eukaryotes) from metagenomic shotgun sequencing data (i.e. not 16S) at species-level. MetaPhlAn 4 relies on ~5.1M unique clade-specific marker genes identified from ~1M microbial genomes (~236,600 references (bacterial, archeal, viral and eukaryotic) and 771,500 metagenomic assembled genomes) spanning 26,970 species-level genome bins.</p>
<p>It allows:
- unambiguous taxonomic assignments;
- accurate estimation of organismal relative abundance;
- species-level resolution for bacteria, archaea, eukaryotes and viruses;
- strain identification and tracking
- orders of magnitude speedups compared to existing methods.
- microbiota strain-level population genomics
- MetaPhlAn clade-abundance estimation</p>
<p>The basic usage of MetaPhlAn consists in the identification of the clades (from phyla to species and strains in particular cases) present in the microbiota obtained from a microbiome sample and their relative abundance.</p>
<p><strong>MetaPhlAn</strong> in Galaxy can not directly take as input a paired collection but expect 2 collections: 1 with forward data and 1 with reverse. Before launching <strong>MetaPhlAn</strong>, we need to split our input paired collection.</p>
<blockquote>
<p>Hands-on: Assign taxonomic labels with MetaPhlAn</p>
<ol>
<li><strong>Unzip collection</strong> – <a href="__UNZIP_COLLECTION__">Tool link</a> with the following parameters:</li>
<li>
<p><em>"Paired input to unzip"</em>: Input paired collection</p>
</li>
<li>
<p><strong>MetaPhlAn</strong> – <a href="toolshed.g2.bx.psu.edu/repos/iuc/metaphlan/metaphlan/4.1.1+galaxy4">Tool link</a> with the following parameters:</p>
</li>
<li>In <em>"Inputs"</em><ul>
<li><em>"Input(s)"</em>: <code>Fasta/FastQ file(s) with microbiota reads</code></li>
<li><em>"Fasta/FastQ file(s) with microbiota reads"</em>: <code>Paired-end files</code><ul>
<li><em>"Forward paired-end Fasta/FastQ file with microbiota reads"</em>: output of <strong>Unzip collection</strong> with <strong>forward</strong> in the name</li>
<li><em>"Reverse paired-end Fasta/FastQ file with microbiota reads"</em>: output of <strong>Unzip collection</strong> with <strong>reverse</strong> in the name</li>
</ul>
</li>
</ul>
</li>
<li>In <em>"Outputs"</em>:<ul>
<li><em>"Output for Krona?"</em>: <code>Yes</code></li>
</ul>
</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p>5 files and a collection are generated by <strong>MetaPhlAn</strong> :</p>
<ul>
<li><code>Predicted taxon relative abundances</code>: tabular files with the <strong>community profile</strong></li>
</ul>
<div class="highlight"><pre><span></span><code>#SampleID    Metaphlan_Analysis      
#clade_name  NCBI_tax_id     relative_abundance  additional_species
k__Bacteria  2   100.0   
k__Bacteria|p__Bacteroidetes     2|976   94.38814    
k__Bacteria|p__Proteobacteria    2|1224  5.61186     
k__Bacteria|p__Bacteroidetes|c__CFGB45935    2|976|  94.38814    
k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria     2|1224|28211    5.61186     
k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935   2|976||     94.38814    
k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales  2|1224|28211|204455     5.61186     
k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935|f__FGB45935   2|976|||    94.38814    
k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales|f__Rhodobacteraceae  2|1224|28211|&gt; 204455|    31989     5.61186     
k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935|f__FGB45935|g__GGB56609   2|976||||   94.38814    
k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales|f__Rhodobacteraceae|g__Phycocomes    2| 1224|    28211|204455|31989|2873978  5.61186     
k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935|f__FGB45935|g__GGB56609|s__GGB56609_SGB78025  2| 976|||||     94.    38814    
k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales|f__Rhodobacteraceae|g__Phycocomes|     s__Phycocomes_zhengii     2|1224|28211|204455|31989|2873978|2056810   5.61186     
k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935|f__FGB45935|g__GGB56609|s__GGB56609_SGB78025| t__SGB78025     2|    976||||||     94.38814    
k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales|f__Rhodobacteraceae|g__Phycocomes|     s__Phycocomes_zhengii|t__SGB31485     2|1224|28211|204455|31989|2873978|2056810|  5.61186     
</code></pre></div>
<p>Each line contains 4 columns:
   1. the lineage with different taxonomic levels, from high level taxa (kingdom: <code>k__</code>) to more precise taxa
   2. the NCBI taxon ids of the lineage taxonomic level
   3. the relative abundance found for our sample for the lineage
   4. any additional species</p>
<blockquote>
<p>Question</p>
<ol>
<li>Which kindgoms have been identified for JC1A?</li>
<li>For JP4D?</li>
<li>How is the diversity for JP4D compared to <strong>Kraken</strong> results?</li>
</ol>
<blockquote>
<p>Solution
1. All reads have been unclassified so no kindgom identified
2. Bacteria, no eukaryotes
3. Diversity is really reduced for JP4D using <strong>MetaPhlAn</strong>, compared to the one identified with <strong>Kraken</strong></p>
</blockquote>
<details class="success">
<summary>Success</summary>
</details>
<p>??? question</p>
</blockquote>
<ul>
<li><code>Predicted taxon relative abundances for Krona</code>: same information as the previous files but formatted for &gt; visualization using <strong>Krona</strong></li>
</ul>
<div class="highlight"><pre><span></span><code>Column 1 Column 2    Column 3    Column 4    Column 5    Column 6    Column 7    Column 8    Column 9    Column 10
94.38814         Bacteria    Bacteroidetes   CFGB45935   OFGB45935   FGB45935    GGB56609    GGB56609 SGB78025   
5.61186      Bacteria    Proteobacteria  Alphaproteobacteria     Rhodobacterales     Rhodobacteraceae    Phycocomes  Phycocomes zhengii  
94.38814         Bacteria    Bacteroidetes   CFGB45935   OFGB45935   FGB45935    GGB56609    GGB56609 SGB78025   SGB78025
5.61186      Bacteria    Proteobacteria  Alphaproteobacteria     Rhodobacterales     Rhodobacteraceae    Phycocomes  Phycocomes zhengii  SGB31485
</code></pre></div>
<p>Each line represent an identified taxons with 9 columns:
   - Column 1: The percentage of reads assigned the taxon
   - Column 2-9: The taxon description at the different taxonomic levels from Kindgom to more precise taxa</p>
<ul>
<li>A <strong>collection</strong> with the same information as in the tabular file but splitted into different files, one per taxonomic level</li>
<li>
<p><code>BIOM file</code> with <strong>community profile</strong> in BIOM format, a common and standard format in microbiomics and used as the input for tools like mothur or Qiime.</p>
</li>
<li>
<p><code>Bowtie2 output</code> and <code>SAM file</code> with the results of the sequence mapping on the reference database</p>
</li>
</ul>
<p>Let's now run <strong>Krona</strong> to visualize the communities</p>
<blockquote>
<p>Hands-on: Generate Krona visualisation
1. <strong>Krona pie chart</strong> – <a href="toolshed.g2.bx.psu.edu/repos/crs4/taxonomy_krona_chart/taxonomy_krona_chart/2.7.1">Tool link</a> with the following parameters:
   - <em>"Type of input data"</em>: <code>tabular</code>
   -  <em>"Input file"</em>: Krona output of <strong>Metaphlan</strong></p>
<ol>
<li>Inspect the generated file</li>
</ol>
</blockquote>
<div class="admonition example">
<p class="admonition-title">Example</p>
</div>
<p>As pointed before, the community looks a lot less diverse than with <strong>Kraken</strong>. This is probably due to the reference database, which is potentially not complete enough yet to identify all taxons. Or there are too few reads in the input data to cover enough marker genes. Indeed, no taxon has been identified for JC1A, which contains much less reads than JP4D. However, <strong>Kraken</strong> is also known to have high number of false positive. A benchmark dataset or mock community where the community DNA content is known would be required to correctly judge which tool provides the better taxonomic classification.</p>
<h1 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">#</a></h1>
<p>In this tutorial, we look how to get the community profile from microbiome data. We apply <strong>Kraken2</strong> or <strong>MetaPhlAn</strong> to assign taxonomic labels to two microbiome sample datasets. We then visualize the results using <strong>Krona</strong>, <strong>Pavian</strong> and <strong>Phinch</strong> to analyze and compare the datasets. Finally, we discuss important facts when it comes to choosing the right tool for taxonomic assignment.å</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "header.autohide", "navigation.footer", "navigation.indexes", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>